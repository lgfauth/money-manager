[build]
builder = "NIXPACKS"

# This config is for the WORKER service
# Make sure Railway Worker service is configured to use Dockerfile.worker

[build.nixpacksPlan]
providers = ["dotnet"]

[build.nixpacksPlan.phases.setup]
nixPkgs = ["dotnet-sdk_9"]

[build.nixpacksPlan.phases.build]
cmds = [
  "dotnet restore src/MoneyManager.Worker/MoneyManager.Worker.csproj",
  "dotnet build src/MoneyManager.Worker/MoneyManager.Worker.csproj --configuration Release --no-restore",
  "dotnet publish src/MoneyManager.Worker/MoneyManager.Worker.csproj --configuration Release --no-build --output /app/publish"
]

[build.nixpacksPlan.start]
cmd = "dotnet /app/publish/MoneyManager.Worker.dll"
